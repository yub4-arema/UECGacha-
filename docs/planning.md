# 要件定義書：ガチャ自販機サイト

## 1. 概要

### 1.1. プロジェクトの背景
大学のキャンパス内に設置された、特定の自動販売機に存在する「二人専用ランダムドリンクボタン」機能（以下、ガチャ）を対象とする。このガチャは、自販機内で最も安い飲料の2倍の価格で、ランダムなドリンクが2本排出される仕様となっており、利用者が金銭的に損をすることはない。

### 1.2. プロジェクトの目的
このガチャ体験をより楽しく、コミュニティで共有できるものにするため、結果の投稿・集計を行うWebサイトを開発する。利用者はガチャの結果を記録し、他の利用者の結果を閲覧し、統計情報を楽しむことができる。これにより、ガチャ体験に新たな価値を付与し、利用者間のコミュニケーションを誘発する。

---

## 2. 機能要件

### 2.1. 機能一覧
- **F-01**: ガチャ結果投稿機能
- **F-02**: 投稿タイムライン表示機能
- **F-03**: 統計情報表示機能
- **F-04**: 個人累計お得額表示機能

### 2.2. 機能詳細
- **F-01: ガチャ結果投稿機能**
    - ユーザーは、ガチャで排出されたドリンク2本の名前を入力する。
    - 任意で、結果の写真をアップロードできる。
    - 投稿日時はシステムが自動的に記録する。
    - AggregateData型のデータを全部加算する。

- **F-02: 投稿タイムライン表示機能**
    - すべてのユーザーの投稿を時系列（新しい順）で表示する。
    - 各投稿には、そのガチャで得した金額（お得度）を表示する。

- **F-03: 統計情報表示機能**
    - 現在の以下の統計情報を表示する。
        1.  **ドリンク別排出率ランキング**: これまで排出された現在のgachaListの全ドリンクの品目別ランキング。
        3.  **サイト全体の累計お得額**: 全ユーザーの総利益額。

- **F-04: 個人累計お得額表示機能**
    - サイト訪問者個人の、これまでのUser型のデータを保存する。
    - この記録は、ユーザー登録を不要とし、ブラウザのローカルストレージ等に保存する。

---

## 3. データ要件
types.ts に定義されたデータ型を使用する。


## 4. 技術要件

### 4.1. 技術スタック
- **フロントエンド**: Next.js 16, React 19, TypeScript
- **スタイリング**: Tailwind CSS
- **UI コンポーネント**: Radix UI
- **バックエンド/データベース**: Firebase
  - **認証**: Firebase Authentication (不要の場合は省略可)
  - **データベース**: Firestore
  - **ストレージ**: Firebase Storage (写真アップロード用)

### 4.2. 開発環境
- **パッケージマネージャー**: npm
- **リンター**: ESLint
- **フォーマッター**: Prettier (必要に応じて)
- **バージョン管理**: Git/GitHub

---



---

## 8. Firestore 関数仕様

### 8.1. 投稿関連関数

#### 8.1.1. `createPost`
- **説明**: ガチャ結果を投稿する

#### 8.1.2. `getPosts`
- **説明**: タイムライン表示用の投稿一覧を取得（新順）

#### 8.1.3. `getPostById`
- **説明**: 特定の投稿を取得

#### 8.1.4. `getMyPost`
- **説明**: 自分の投稿した投稿一覧を取得


### 8.2. ドリンク関連関数
#### 8.2.1. `getDrinkList`
- **説明**: ドリンク一覧を取得


### 8.3. 統計関連関数

#### 8.3.1. `getDrinkRanking`
- **説明**: ドリンク別排出率ランキングを取得


#### 8.3.3. `getTotalProfit(): Promise<number>`
- **説明**: サイト全体の累計お得額を取得
